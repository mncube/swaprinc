
<!-- README.md is generated from README.Rmd. Please edit that file -->

# swaprinc

<!-- badges: start -->
<!-- badges: end -->

The goal of swaprinc is to help compare a regression model with raw
variables to a regression model where some of the raw variables have
been swapped out for principal components.

## Installation

You can install the development version of swaprinc from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("mncube/swaprinc")
```

## A Simple Example

In the example below, a regression model is used to estimate the
relation between x1 and y after controlling for x2 - x5.

Using the default engine of “stats” specifies that stats::lm will be
used to fit the statistical model and using the default prc_eng of
“stats” specifies that stats::prcomp will be used to extract principal
components.

The formula parameter specifies the “raw model” which will be passed to
stats::lm. The pca_vars and n_pca_components parameters specify that raw
variables x2 - x5 will be used to extract 2 principal components, and
then the following “pca model” will be passed to stats::lm: y \~ x1 +
PC1 + PC2

``` r
library(swaprinc)

  # Create a small simulated dataset
  set.seed(42)
  n <- 50
  x1 <- rnorm(n)
  x2 <- rnorm(n, 5, 15)
  x3 <- rnorm(n, -5.5, 20)
  x4 <- rnorm(n, 3, 3)
  x5 <- rnorm(n, -2, 4)
  y <- 1 + 2 * x1 + 3 * x2 + 2.5*x4 - 3.5*x5 + rnorm(n)
  data <- data.frame(y, x1, x2, x3, x4, x5)

  # Run swaprinc with
  swaprinc_result <- swaprinc(data,
                              formula = "y ~ x1 + x2 + x3 + x4 + x5",
                              pca_vars = c("x2", "x3", "x4", "x5"),
                              n_pca_components = 2)
#>             y          x1          x2         x3          x4           x5
#> 1   74.340168  1.37095845   9.8288790  18.519308  2.87790457 -10.00371695
#> 2  -22.162565 -0.56469817  -6.7575841  15.395022 -1.65463447  -0.66489121
#> 3   93.290719  0.36312841  28.6359128 -25.564173  6.50150865   2.68530051
#> 4   30.000321  0.63286260  14.6434896  31.469638  2.17906290   6.23815697
#> 5   52.412694  0.40426832   6.3464097 -18.835468  1.59646403  -7.50744639
#> 6   48.523746 -0.10612452   9.1482612  -3.389724 -0.71475698  -6.60342226
#> 7   73.175884  1.51152200  15.1893322 -13.945118  2.97671390  -4.82328558
#> 8   43.154390 -0.09465904   6.3474933  -7.947003  0.59915347  -6.21622313
#> 9  -96.130583  2.01842371 -39.8963512  -1.736139  1.39952301  -4.58297489
#> 10  55.063877 -0.06271410   9.2732443  -3.116781  6.86302574  -2.74151187
#> 11  32.957600  1.30486965  -0.5085196  -6.001851  2.47342239  -6.80488820
#> 12   7.822233  2.28664539   7.7784585  -3.338545 -0.21534715   6.14788867
#> 13  54.003398 -1.38886070  13.7273559 -15.208705  3.48962065  -1.56890102
#> 14  89.535999 -0.27878877  25.9960524 -15.584343  1.91178475  -2.33643240
#> 15  -5.062355 -0.13332134  -5.9093809 -38.721982  4.77004064  -0.01752143
#> 16 101.670444  0.63595040  24.5381395 -13.146675  7.29726578  -1.85033926
#> 17  40.261893 -0.28425292  10.0377218 -15.753005  0.02192247  -2.52835215
#> 18  54.463900 -2.65645542  20.5775915  48.537820  4.36395089   3.90714969
#> 19  68.027080 -2.44046693  18.8109285 -32.742325  3.25469418  -2.86812084
#> 20  90.327883  1.32011335  15.8131724  -2.754876  5.68669675  -7.13440882
#> 21 -23.602564 -0.30663859 -10.6467841 -35.372501  2.31066558  -0.45732844
#> 22  34.120623 -1.78130843   3.6472042 -34.908715  5.50985721  -3.40605149
#> 23  52.589121 -0.17191736  14.3527724  -3.005952 -2.23516758  -4.08718437
#> 24  18.077142  1.21467470  -9.3028504 -25.432783  8.06837676  -6.27252480
#> 25   9.955253  1.89519346  -3.1424322  -5.536452  5.59433394  -0.28653639
#> 26  58.399318 -0.43046913  13.7149475 -14.065178  2.54767203  -2.69607294
#> 27  46.936996 -0.25726938  16.5226811 -17.773432 -1.34702139   0.06267091
#> 28  54.704224 -1.76316309  11.9565138 -45.993557  4.92902610  -2.93746111
#> 29   5.784839  0.46009735  -8.2866445 -29.994959  4.44958159  -4.63401370
#> 30 -36.616651 -0.63999488 -11.4967135  -1.909671  2.98093312   3.00094642
#> 31 105.247401  0.45545012  27.6906051   5.852412  3.45436768  -3.08705486
#> 32  24.201365  0.70483734   8.8688216 -15.357547  1.24767309   1.79180798
#> 33  55.568916  1.03510352   6.3266034  -5.498742  4.10642020  -6.80632972
#> 34  33.212850 -0.60892638   3.1865519  16.957793  3.88396302  -3.86446439
#> 35 -20.514694  0.50495512 -12.9149334  23.297115  2.16222188  -3.07740558
#> 36  50.405596 -1.71700868  14.1799535 -27.442275 -1.00870996  -3.56386163
#> 37   7.993100 -0.78445901   1.7429023  -7.846391  5.10224646   3.39482805
#> 38  24.230933 -0.85090759   2.2586494  18.529968  4.66258987  -2.09105881
#> 39  55.867508 -2.41420765  19.0001949 -14.894592  0.49108022  -1.02309660
#> 40  69.059523  0.03612261  17.3265967  -6.549390 -1.78376449  -5.76948683
#> 41 104.615869  0.20599860  25.8817456  -7.222146  3.61487574  -4.91686911
#> 42  -7.765025 -0.36105730  -2.1426088 -23.253580  1.96473607   1.99227563
#> 43  44.745471  0.75816324  14.7552284 -14.393680  3.75783511   3.03392666
#> 44  66.669506 -0.72670483  25.8666568  -6.088898 -0.88200740   2.99545476
#> 45 -10.210627 -1.36828104 -11.6618332 -13.777377  0.12248867  -7.52254820
#> 46 -28.403504  0.43281803  -7.9118888  16.767720  6.25732456   6.19984277
#> 47 -33.425196 -0.81139318 -11.9760802 -15.119857  4.21132471   2.06749132
#> 48 -26.641163  1.44410126 -16.8882100 -14.163381  4.75946261  -2.10686986
#> 49  37.097367 -0.43144620   6.1997383   8.437252  8.44568534   0.81443112
#> 50  74.145428  0.65564788  14.7980651 -26.627368  3.38646429  -5.88554092
#>             y          x1         PC1         PC2
#> 1   74.340168  1.37095845  26.6518189   3.4115665
#> 2  -22.162565 -0.56469817  24.0723760 -13.0207938
#> 3   93.290719  0.36312841 -17.0040500  22.0051188
#> 4   30.000321  0.63286260  40.2506892   8.5065351
#> 5   52.412694  0.40426832 -10.5293176  -0.2768803
#> 6   48.523746 -0.10612452   4.9309037   2.6735877
#> 7   73.175884  1.51152200  -5.6006498   8.6074250
#> 8   43.154390 -0.09465904   0.4086884  -0.1725931
#> 9  -96.130583  2.01842371   7.0188072 -46.3586219
#> 10  55.063877 -0.06271410   5.3309104   2.7321872
#> 11  32.957600  1.30486965   2.3681705  -7.0483278
#> 12   7.822233  2.28664539   5.5335816   1.4407425
#> 13  54.003398 -1.38886070  -6.7159657   7.1662666
#> 14  89.535999 -0.27878877  -7.2064155  19.4446315
#> 15  -5.062355 -0.13332134 -30.0028348 -12.6277160
#> 16 101.670444  0.63595040  -4.7655597  17.9296261
#> 17  40.261893 -0.28425292  -7.2569028   3.5139757
#> 18  54.463900 -2.65645542  57.1491863  14.4969054
#> 19  68.027080 -2.44046693 -24.3245414  12.1185931
#> 20  90.327883  1.32011335   5.4627697   9.2411335
#> 21 -23.602564 -0.30663859 -26.6286867 -17.3101393
#> 22  34.120623 -1.78130843 -26.4114098  -3.0961976
#> 23  52.589121 -0.17191736   5.3907706   7.9304654
#> 24  18.077142  1.21467470 -16.9840281 -16.0494006
#> 25   9.955253  1.89519346   3.1154649  -9.6511226
#> 26  58.399318 -0.43046913  -5.6169757   7.1628126
#> 27  46.936996 -0.25726938  -9.2058888  10.0333333
#> 28  54.704224 -1.76316309 -37.5239251   5.1500548
#> 29   5.784839  0.46009735 -21.4620183 -14.9925501
#> 30 -36.616651 -0.63999488   6.9529187 -17.9035570
#> 31 105.247401  0.45545012  14.1581228  21.2532305
#> 32  24.201365  0.70483734  -6.6748703   2.3786033
#> 33  55.568916  1.03510352   2.8127214  -0.2352181
#> 34  33.212850 -0.60892638  25.3975494  -3.1857136
#> 35 -20.514694  0.50495512  31.8908715 -19.2067449
#> 36  50.405596 -1.71700868 -19.0046858   7.5795404
#> 37   7.993100 -0.78445901   0.9312653  -4.7336849
#> 38  24.230933 -0.85090759  27.0469366  -4.0942528
#> 39  55.867508 -2.41420765  -6.4031229  12.4905744
#> 40  69.059523  0.03612261   1.7549415  10.8540290
#> 41 104.615869  0.20599860   1.0304189  19.3329430
#> 42  -7.765025 -0.36105730 -14.4775134  -8.6926146
#> 43  44.745471  0.75816324  -5.7142167   8.2473920
#> 44  66.669506 -0.72670483   2.5218527  19.4810323
#> 45 -10.210627 -1.36828104  -5.3374279 -18.2256916
#> 46 -28.403504  0.43281803  25.7069575 -14.2048495
#> 47 -33.425196 -0.81139318  -6.2869579 -18.5012062
#> 48 -26.641163  1.44410126  -5.4760390 -23.4610082
#> 49  37.097367 -0.43144620  17.0405914  -0.2455137
#> 50  74.145428  0.65564788 -18.3152811   8.1120925
  
  # Summarize raw model
  summary(swaprinc_result$model_raw)
#> 
#> Call:
#> stats::lm(formula = formula, data = data)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -2.2078 -0.7133  0.1050  0.5922  2.3326 
#> 
#> Coefficients:
#>              Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  1.248074   0.266265   4.687 2.69e-05 ***
#> x1           2.100421   0.141096  14.886  < 2e-16 ***
#> x2           2.989333   0.011418 261.814  < 2e-16 ***
#> x3           0.001554   0.008540   0.182    0.856    
#> x4           2.466510   0.058922  41.861  < 2e-16 ***
#> x5          -3.453063   0.040480 -85.302  < 2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 1.075 on 44 degrees of freedom
#> Multiple R-squared:  0.9994, Adjusted R-squared:  0.9994 
#> F-statistic: 1.544e+04 on 5 and 44 DF,  p-value: < 2.2e-16
  
  # Summarize pca model
  summary(swaprinc_result$model_pca)
#> 
#> Call:
#> stats::lm(formula = formula, data = data)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -40.823 -10.372   2.680   9.709  28.259 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  34.8087     2.0588  16.908   <2e-16 ***
#> x1            4.6579     1.8697   2.491   0.0164 *  
#> PC1          -0.1961     0.1126  -1.741   0.0883 .  
#> PC2           2.9641     0.1543  19.210   <2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 14.55 on 46 degrees of freedom
#> Multiple R-squared:  0.891,  Adjusted R-squared:  0.8839 
#> F-statistic: 125.3 on 3 and 46 DF,  p-value: < 2.2e-16
  
  # Get model comparisons
  print(swaprinc_result$comparison)
#>   model r_squared adj_r_squared      AIC      BIC
#> 1   Raw 0.9994305     0.9993657 156.7677 170.1519
#> 2   PCA 0.8909947     0.8838856 415.4838 425.0440
```
