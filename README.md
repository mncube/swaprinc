
<!-- README.md is generated from README.Rmd. Please edit that file -->

# swaprinc

<!-- badges: start -->
<!-- badges: end -->

The goal of swaprinc is to help compare a regression model with raw
variables to a regression model where some of the raw variables have
been swapped out for principal components.

## Installation

You can install the development version of swaprinc from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("mncube/swaprinc")
```

## A Simple Example

In the example below, a regression model is used to estimate the
relation between x1 and y after controlling for x2 - x5.

Using the default engine of “stats” specifies that stats::lm will be
used to fit the statistical model and using the default prc_eng of
“stats” specifies that stats::prcomp will be used to extract principal
components.

The formula parameter specifies the “raw model” which will be passed to
stats::lm. The pca_vars and n_pca_components parameters specify that raw
variables x2 - x5 will be used to extract 2 principal components, and
then the following “pca model” will be passed to stats::lm: y \~ x1 +
PC1 + PC2

``` r
library(swaprinc)

  # Create a small simulated dataset
  set.seed(40)
  n <- 50
  x1 <- rnorm(n)
  x2 <- rnorm(n, 5, 15)
  x3 <- rnorm(n, -5.5, 20)
  x4 <- rnorm(n, 3, 3)
  x5 <- rnorm(n, -2, 4)
  y <- 1 + 2 * x1 + 3 * x2 + 2.5*x4 - 3.5*x5 + rnorm(n)
  data <- data.frame(y, x1, x2, x3, x4, x5)

  # Run swaprinc with
  swaprinc_result <- swaprinc(data,
                              formula = "y ~ x1 + x2 + x3 + x4 + x5",
                              pca_vars = c("x2", "x3", "x4", "x5"),
                              n_pca_components = 2)
#>             y          x1          x2         x3          x4         x5
#> 1   78.454845  0.47773904  18.7383130  -8.773589  2.52720457 -3.8606150
#> 2   35.166462  0.49618282  13.6177720 -13.933367 -0.82382883  1.3881899
#> 3   -6.232960 -0.85958430  -2.2810604  -1.773555  1.88459954  0.7971805
#> 4   22.532193 -0.82905996   5.2361401  62.775202  2.90731530  0.3133659
#> 5   99.333208 -0.32157308  20.2132202  -7.899481  5.40616547 -6.7139638
#> 6   49.510460 -1.30377040   5.8722388 -17.541489  1.87346470 -8.2771314
#> 7  132.151837 -1.42148660  39.0244323  -6.002883  0.58073168 -4.3392270
#> 8   77.298531  1.74491495  15.6297978 -23.468726  1.68864409 -6.2768443
#> 9   88.246099 -0.28827936  28.5871818 -12.469999 -0.56885907 -1.5634062
#> 10  69.066041 -1.30886572  18.3080345 -12.286187  6.55179873  0.1771401
#> 11 -36.321914 -0.06945219 -16.1750371   1.317377  0.04101577 -3.5692460
#> 12  79.020656 -1.22492668  17.0566269  34.717773  0.03535449 -8.0920351
#> 13  11.698614  0.80899626  -3.2857059 -35.477599 11.33618175  2.8344420
#> 14  35.514656 -0.49215034  11.3860745  23.228872  3.96417145  2.5039409
#> 15 -15.837830  0.45269393  -6.5571196 -10.812509  0.90958159  0.4262883
#> 16  28.113738  0.99963310  -4.4288023 -18.425761  5.75451389 -7.2415785
#> 17  22.999681  0.46702960   4.7241553 -14.012933 -1.69698556 -3.4505958
#> 18   6.491463  0.37605199  -4.8996119 -11.818129  5.22575558 -1.8185812
#> 19   3.525685  1.70349095  -2.6564299  -6.134988 -1.56215186 -3.3571804
#> 20  31.654959 -1.03546152  14.6955564 -24.506841  3.76034012  5.6992618
#> 21  17.747100  1.32812210  -1.9895743  -8.528803  2.98585810 -3.1507673
#> 22 111.592773 -0.59428711  25.6319046 -15.546777  3.27695176 -7.5819841
#> 23  84.594685  1.61128458  22.9639935 -31.064006  3.66353730 -0.2598985
#> 24 -20.324313 -1.11267383  -4.2449467 -17.133744 -2.51699367  0.2791810
#> 25 -22.413548 -1.46018298 -10.5841940 -13.499040  0.80673200 -2.9183093
#> 26  38.056965  0.73215598  10.9932423   8.075351  2.29265608  0.9112851
#> 27  43.605151 -1.61033943   8.3087131  -8.205605  8.93806241  0.3599756
#> 28  50.766110  0.33206736  10.9593663   1.071770  1.70452560 -3.2370289
#> 29  32.474347  0.76085616   5.4054455  20.642732  0.28066519 -3.3934682
#> 30  62.919474 -1.85366955  23.5110932  26.622061  1.43705060  2.8240235
#> 31  49.310391  0.79115157   5.4591328  -6.452399  8.31312514 -2.3270574
#> 32 -12.457700 -1.28174039 -15.4587114  32.115782  8.73265718 -3.9093965
#> 33  47.587564 -0.77987734  18.5743065  -2.102877 -0.36158249  1.8023324
#> 34 -70.816178  1.43834228 -26.0414246   3.880662  0.90639369 -1.0912721
#> 35  21.980783 -0.23482954   8.1918257 -19.407632  3.60129629  3.7541593
#> 36  27.968790  0.61219714   6.8603411   5.324253 -1.81089497 -2.4856011
#> 37  48.500776 -1.45847063   5.8029624 -35.248747  6.64258779 -4.8247843
#> 38  37.695174  0.24276907   9.9507763  47.259884 -4.93628370 -4.8554138
#> 39 109.076242 -0.31739211  29.9739944  -4.100188  4.59754448 -1.6351588
#> 40  21.574685  0.85937333   0.4359594 -33.133698  2.38481685 -3.3488198
#> 41 -35.979612  1.34415507 -16.1773607   1.224252 -1.67623297 -3.8204587
#> 42  94.500471  0.31555720  26.3215622 -10.682936 -2.29742273 -5.3155530
#> 43   3.098434  2.04544486  -4.7911703   4.888043  2.89449527 -1.0730800
#> 44 -29.311352 -0.18247053 -20.0750636   3.974270  4.17455011 -5.7885772
#> 45 -36.313994 -1.48393823  -8.0869199   9.946346 -1.33859784  2.1918645
#> 46 101.403160  0.39716563  17.5883375  14.899321  6.84444431 -8.7589200
#> 47 -38.444040  1.56965755 -12.5200583   7.718097  4.90800226  4.8723105
#> 48  68.099961  1.27023296  21.3109947 -12.070845  0.12267910  0.2316382
#> 49  81.799478 -0.87144335  17.8876096 -15.503695  3.62275977 -5.2781319
#> 50  22.038750  0.36088326   3.4197420 -23.591043  3.05173022 -0.7646976
#>             y          x1         PC1        PC2
#> 1   78.454845  0.47773904  -6.8162575 -11.361841
#> 2   35.166462  0.49618282 -11.1856358  -5.575049
#> 3   -6.232960 -0.85958430   2.7896331   8.705854
#> 4   22.532193 -0.82905996  65.7991795  -6.845443
#> 5   99.333208 -0.32157308  -6.2255336 -12.944077
#> 6   49.510460 -1.30377040 -13.8473860   2.367204
#> 7  132.151837 -1.42148660  -6.5669703 -31.878996
#> 8   77.298531  1.74491495 -20.9566815  -6.515073
#> 9   88.246099 -0.28827936 -11.6277595 -20.671754
#> 10  69.066041 -1.30886572 -10.3918840 -10.300097
#> 11 -36.321914 -0.06945219   7.6853685  21.939333
#> 12  79.020656 -1.22492668  36.6097364 -15.322480
#> 13  11.698614  0.80899626 -30.8230305  14.198073
#> 14  35.514656 -0.49215034  25.7736843  -7.895301
#> 15 -15.837830  0.45269393  -5.5968406  14.049713
#> 16  28.113738  0.99963310 -13.5559737  12.804607
#> 17  22.999681  0.46702960 -10.0968324   3.108153
#> 18   6.491463  0.37605199  -6.9431273  12.570195
#> 19   3.525685  1.70349095  -1.3583738   9.441784
#> 20  31.654959 -1.03546152 -21.9717522  -5.102102
#> 21  17.747100  1.32812210  -3.9704400   9.187527
#> 22 111.592773 -0.59428711 -14.4175759 -17.425780
#> 23  84.594685  1.61128458 -29.4977444 -12.633089
#> 24 -20.324313 -1.11267383 -12.0395924  12.471425
#> 25 -22.413548 -1.46018298  -7.7381545  18.291046
#> 26  38.056965  0.73215598  10.8613393  -5.680668
#> 27  43.605151 -1.61033943  -5.1634821  -0.840751
#> 28  50.766110  0.33206736   3.9539614  -4.887872
#> 29  32.474347  0.76085616  24.1073220  -1.875214
#> 30  62.919474 -1.85366955  27.6893193 -20.391160
#> 31  49.310391  0.79115157  -3.0363303   1.680873
#> 32 -12.457700 -1.28174039  37.8348743  17.544383
#> 33  47.587564 -0.77987734  -0.1004506 -11.954501
#> 34 -70.816178  1.43834228  11.4377175  31.483205
#> 35  21.980783 -0.23482954 -16.0832633   0.651841
#> 36  27.968790  0.61219714   8.8049713  -1.416393
#> 37  48.500776 -1.45847063 -31.5646956   4.855403
#> 38  37.695174  0.24276907  50.1014539  -9.878950
#> 39 109.076242 -0.31739211  -3.6800095 -22.985391
#> 40  21.574685  0.85937333 -28.6493309   9.854871
#> 41 -35.979612  1.34415507   7.6521808  21.908734
#> 42  94.500471  0.31555720  -9.5005003 -18.785454
#> 43   3.098434  2.04544486   9.6823604  10.331762
#> 44 -29.311352 -0.18247053  10.6788354  25.506619
#> 45 -36.313994 -1.48393823  15.2478787  12.954788
#> 46 101.403160  0.39716563  16.6660158 -13.226448
#> 47 -38.444040  1.56965755  13.3802584  17.838123
#> 48  68.099961  1.27023296 -10.3405838 -13.445754
#> 49  81.799478 -0.87144335 -13.4139602  -9.685412
#> 50  22.038750  0.36088326 -19.5959379   5.779538
  
  # Summarize raw model
  summary(swaprinc_result$model_raw)
#> 
#> Call:
#> stats::lm(formula = formula, data = data)
#> 
#> Residuals:
#>      Min       1Q   Median       3Q      Max 
#> -2.55636 -0.54649  0.06157  0.67265  1.53376 
#> 
#> Coefficients:
#>              Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  1.067939   0.197911   5.396 2.58e-06 ***
#> x1           2.128082   0.134754  15.792  < 2e-16 ***
#> x2           3.027693   0.009895 305.984  < 2e-16 ***
#> x3           0.015585   0.007071   2.204   0.0328 *  
#> x4           2.525566   0.042032  60.087  < 2e-16 ***
#> x5          -3.470523   0.038733 -89.602  < 2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 0.9473 on 44 degrees of freedom
#> Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
#> F-statistic: 2.307e+04 on 5 and 44 DF,  p-value: < 2.2e-16
  
  # Summarize pca model
  summary(swaprinc_result$model_pca)
#> 
#> Call:
#> stats::lm(formula = formula, data = data)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -26.280 -10.353  -1.162   7.129  33.692 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  34.4159     2.0764  16.575  < 2e-16 ***
#> x1            1.6814     2.0581   0.817    0.418    
#> PC1          -0.4463     0.1046  -4.266  9.8e-05 ***
#> PC2          -3.0291     0.1526 -19.855  < 2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 14.68 on 46 degrees of freedom
#> Multiple R-squared:  0.9043, Adjusted R-squared:  0.898 
#> F-statistic: 144.8 on 3 and 46 DF,  p-value: < 2.2e-16
  
  # Get model comparisons
  print(swaprinc_result$comparison)
#>   model r_squared adj_r_squared      AIC      BIC
#> 1   Raw 0.9996186     0.9995753 144.0841 157.4682
#> 2   PCA 0.9042644     0.8980208 416.3615 425.9216
```
