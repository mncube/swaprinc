
<!-- README.md is generated from README.Rmd. Please edit that file -->

# swaprinc

<!-- badges: start -->
<!-- badges: end -->

The goal of swaprinc is to help compare a regression model with raw
variables to a regression model where some of the raw variables have
been swapped out for principal components.

## Installation

You can install the development version of swaprinc from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("mncube/swaprinc")
```

## A Simple Example

In the example below, a regression model is used to estimate the
relation between x1 and y after controlling for x2 - x5.

Using the default engine of “stats” specifies that stats::lm will be
used to fit the statistical model and using the default prc_eng of
“stats” specifies that stats::prcomp will be used to extract principal
components.

The formula parameter specifies the “raw model” which will be passed to
stats::lm. The pca_vars and n_pca_components parameters specify that raw
variables x2 - x5 will be used to extract 2 principal components, and
then the following “pca model” will be passed to stats::lm: y \~ x1 +
PC1 + PC2

``` r
library(swaprinc)

  # Create a small simulated dataset
  set.seed(42)
  n <- 50
  x1 <- rnorm(n)
  x2 <- rnorm(n)
  x3 <- rnorm(n)
  x4 <- rnorm(n)
  x5 <- rnorm(n)
  y <- 1 + 2 * x1 + 3 * x2 + 2.5*x4 - 3.5*x5 + rnorm(n)
  data <- data.frame(y, x1, x2, x3, x4, x5)

  # Run swaprinc with
  swaprinc_result <- swaprinc(data,
                              formula = "y ~ x1 + x2 + x3 + x4 + x5",
                              pca_vars = c("x2", "x3", "x4", "x5"),
                              n_pca_components = 2)
#>              y          x1          x2            x3           x4          x5
#> 1  10.51304259  1.37095845  0.32192527  1.200965e+00 -0.040698475 -2.00092924
#> 2  -7.47894496 -0.56469817 -0.78383894  1.044751e+00 -1.551544822  0.33377720
#> 3   4.07322945  0.36312841  1.57572752 -1.003209e+00  1.167169549  1.17132513
#> 4  -3.50805948  0.63286260  0.64289931  1.848482e+00 -0.273645701  2.05953924
#> 5   7.02492677  0.40426832  0.08976065 -6.667734e-01 -0.467845325 -1.37686160
#> 6   1.51589315 -0.10612452  0.27655075  1.055138e-01 -1.238252328 -1.15085557
#> 7   7.77343949  1.51152200  0.67928882 -4.222559e-01 -0.007762034 -0.70582139
#> 8   2.81523431 -0.09465904  0.08983289 -1.223502e-01 -0.800282178 -1.05405578
#> 9  -4.03364674  2.01842371 -2.99309008  1.881930e-01 -0.533492330 -0.64574372
#> 10  5.21394770 -0.06271410  0.28488295  1.191610e-01  1.287675246 -0.18537797
#> 11  7.14625329  1.30486965 -0.36723464 -2.509255e-02 -0.175525870 -1.20122205
#> 12 -2.71033105  2.28664539  0.18523056  1.080727e-01 -1.071782384  2.03697217
#> 13  0.38240204 -1.38886070  0.58182373 -4.854352e-01  0.163206882  0.10777474
#> 14  2.17760960 -0.27878877  1.39973683 -5.042171e-01 -0.362738416 -0.08410810
#> 15 -1.76215046 -0.13332134 -0.72729206 -1.661099e+00  0.590013548  0.49561964
#> 16 10.69440357  0.63595040  1.30254263 -3.823337e-01  1.432421928  0.03741519
#> 17  0.23281041 -0.28425292  0.33584812 -5.126503e-01 -0.992692511 -0.13208804
#> 18 -5.42033926 -2.65645542  1.03850610  2.701891e+00  0.454650298  1.47678742
#> 19 -2.84682708 -2.44046693  0.92072857 -1.362116e+00  0.084898059 -0.21703021
#> 20 12.59534949  1.32011335  0.72087816  1.372562e-01  0.895565582 -1.28360220
#> 21 -4.09316527 -0.30663859 -1.04311894 -1.493625e+00 -0.229778139  0.38566789
#> 22  0.53447028 -1.78130843 -0.09018639 -1.470436e+00  0.836619068 -0.35151287
#> 23  0.14777899 -0.17191736  0.62351816  1.247024e-01 -1.745055861 -0.52179609
#> 24  8.96245120  1.21467470 -0.95352336 -9.966391e-01  1.689458921 -1.06813120
#> 25  3.42801503  1.89519346 -0.54282881 -1.822614e-03  0.864777979  0.42836590
#> 26  3.42415330 -0.43046913  0.58099650 -4.282589e-01 -0.150775989 -0.17401823
#> 27 -2.16696403 -0.25726938  0.76817874 -6.136716e-01 -1.449007130  0.51566773
#> 28  0.05010655 -1.76316309  0.46376759 -2.024678e+00  0.643008700 -0.23436528
#> 29  4.15718792  0.46009735 -0.88577630 -1.224748e+00  0.483193864 -0.65850343
#> 30 -6.76659069 -0.63999488 -1.09978090  1.795164e-01 -0.006355626  1.25023660
#> 31  8.60290797  0.45545012  1.51270701  5.676206e-01  0.151455893 -0.27176372
#> 32 -3.25729483  0.70483734  0.25792144 -4.928774e-01 -0.584108970  0.94795200
#> 33  7.89377672  1.03510352  0.08844023  6.288407e-05  0.368806733 -1.20158243
#> 34  2.42301364 -0.60892638 -0.12089654  1.122890e+00  0.294654340 -0.46611610
#> 35 -1.28477298  0.50495512 -1.19432890  1.439856e+00 -0.279259373 -0.26935140
#> 36 -2.22222707 -1.71700868  0.61199690 -1.097114e+00 -1.336236655 -0.39096541
#> 37 -1.72934650 -0.78445901 -0.21713985 -1.173196e-01  0.700748818  1.34870701
#> 38 -0.60329762 -0.85090759 -0.18275671  1.201498e+00  0.554196622 -0.02276470
#> 39 -6.08713339 -2.41420765  0.93334633 -4.697296e-01 -0.836306593  0.24422585
#> 40  3.12309039  0.03612261  0.82177311 -5.246948e-02 -1.594588162 -0.94237171
#> 41  7.96540641  0.20599860  1.39211638 -8.610730e-02  0.204958581 -0.72921728
#> 42 -5.06055644 -0.36105730 -0.47617392 -8.876790e-01 -0.345087978  0.99806891
#> 43 -0.11816914  0.75816324  0.65034856 -4.446840e-01  0.252611703  1.25848166
#> 44 -1.67405188 -0.72670483  1.39111046 -2.944488e-02 -1.294002465  1.24886369
#> 45 -2.75833114 -1.36828104 -1.11078888 -4.138688e-01 -0.959170444 -1.38063705
#> 46 -5.65450251  0.43281803 -0.86079259  1.113386e+00  1.085774854  2.04996069
#> 47 -6.73388153 -0.81139318 -1.13173868 -4.809928e-01  0.403774905  1.01687283
#> 48  1.93285387  1.44410126 -1.45921400 -4.331690e-01  0.586487537 -0.02671746
#> 49  2.54983963 -0.43144620  0.07998255  6.968626e-01  1.815228446  0.70360778
#> 50  6.36719392  0.65564788  0.65320434 -1.056368e+00  0.128821429 -0.97138523
#>              y          x1         PC1        PC2
#> 1  10.51304259  1.37095845  0.89251058 -0.4608793
#> 2  -7.47894496 -0.56469817 -0.62928272 -0.2255634
#> 3   4.07322945  0.36312841 -0.75652244 -0.4308787
#> 4  -3.50805948  0.63286260 -2.76628810 -0.7706406
#> 5   7.02492677  0.40426832  1.48835653 -0.2157974
#> 6   1.51589315 -0.10612452  0.99308089 -0.8776337
#> 7   7.77343949  1.51152200  0.69875646 -0.4671457
#> 8   2.81523431 -0.09465904  0.97873972 -0.4534220
#> 9  -4.03364674  2.01842371  0.59966508  2.2348787
#> 10  5.21394770 -0.06271410 -0.21107970  0.5010059
#> 11  7.14625329  1.30486965  0.97034885  0.2415866
#> 12 -2.71033105  2.28664539 -1.63914781 -0.5796562
#> 13  0.38240204 -1.38886070  0.04539928 -0.2520817
#> 14  2.17760960 -0.27878877  0.25260405 -1.2201494
#> 15 -1.76215046 -0.13332134  0.37625722  1.2428484
#> 16 10.69440357  0.63595040 -0.19701049 -0.1931963
#> 17  0.23281041 -0.28425292  0.45589606 -0.6697200
#> 18 -5.42033926 -2.65645542 -2.89648852 -0.8522224
#> 19 -2.84682708 -2.44046693  0.78654154 -0.4712454
#> 20 12.59534949  1.32011335  0.71702633 -0.1201086
#> 21 -4.09316527 -0.30663859  0.52334787  1.0417532
#> 22  0.53447028 -1.78130843  0.89047255  0.7817508
#> 23  0.14777899 -0.17191736  0.53020456 -1.4135391
#> 24  8.96245120  1.21467470  1.12698769  1.8623424
#> 25  3.42801503  1.89519346 -0.53377642  1.0078375
#> 26  3.42415330 -0.43046913  0.29516058 -0.4383748
#> 27 -2.16696403 -0.25726938  0.03092485 -1.2328148
#> 28  0.05010655 -1.76316309  1.09968784  0.2965478
#> 29  4.15718792  0.46009735  1.10714415  1.2106186
#> 30 -6.76659069 -0.63999488 -1.13551178  1.0175627
#> 31  8.60290797  0.45545012 -0.27100342 -1.1932735
#> 32 -3.25729483  0.70483734 -0.50032800 -0.3443278
#> 33  7.89377672  1.03510352  0.84443837  0.1484324
#> 34  2.42301364 -0.60892638 -0.35049702  0.1620589
#> 35 -1.28477298  0.50495512 -0.53462341  0.7164709
#> 36 -2.22222707 -1.71700868  1.02873654 -1.0148407
#> 37 -1.72934650 -0.78445901 -1.21505281  0.7029167
#> 38 -0.60329762 -0.85090759 -0.79484523  0.3599550
#> 39 -6.08713339 -2.41420765  0.06655752 -1.0746812
#> 40  3.12309039  0.03612261  0.93665740 -1.4922190
#> 41  7.96540641  0.20599860  0.46023793 -0.9947124
#> 42 -5.06055644 -0.36105730 -0.32293478  0.4509500
#> 43 -0.11816914  0.75816324 -0.93687390 -0.2189234
#> 44 -1.67405188 -0.72670483 -0.94880956 -1.7181557
#> 45 -2.75833114 -1.36828104  1.49719668  0.4889595
#> 46 -5.65450251  0.43281803 -2.49128316  1.3075646
#> 47 -6.73388153 -0.81139318 -0.64612119  1.3426877
#> 48  1.93285387  1.44410126  0.17026998  1.6630766
#> 49  2.54983963 -0.43144620 -1.32938746  0.9121204
#> 50  6.36719392  0.65564788  1.24366082 -0.2977223
  
  # Summarize raw model
  summary(swaprinc_result$model_raw)
#> 
#> Call:
#> stats::lm(formula = formula, data = data)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -2.2078 -0.7133  0.1050  0.5922  2.3326 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)  0.99185    0.15522   6.390 9.01e-08 ***
#> x1           2.10042    0.14110  14.886  < 2e-16 ***
#> x2           2.83999    0.17127  16.582  < 2e-16 ***
#> x3           0.03108    0.17080   0.182    0.856    
#> x4           2.39953    0.17677  13.575  < 2e-16 ***
#> x5          -3.31225    0.16192 -20.456  < 2e-16 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 1.075 on 44 degrees of freedom
#> Multiple R-squared:  0.9608, Adjusted R-squared:  0.9564 
#> F-statistic: 215.9 on 5 and 44 DF,  p-value: < 2.2e-16
  
  # Summarize pca model
  summary(swaprinc_result$model_pca)
#> 
#> Call:
#> stats::lm(formula = formula, data = data)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -8.3007 -2.7250 -0.5886  2.5265  8.1953 
#> 
#> Coefficients:
#>             Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)   1.1976     0.5409   2.214  0.03181 *  
#> x1            2.3168     0.4885   4.742 2.08e-05 ***
#> PC1           2.1410     0.5181   4.132  0.00015 ***
#> PC2          -1.2934     0.5948  -2.175  0.03483 *  
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 3.823 on 46 degrees of freedom
#> Multiple R-squared:  0.4827, Adjusted R-squared:  0.4489 
#> F-statistic: 14.31 on 3 and 46 DF,  p-value: 1.02e-06
  
  # Get model comparisons
  print(swaprinc_result$comparison)
#>   model r_squared adj_r_squared      AIC      BIC
#> 1   Raw 0.9608414     0.9563916 156.7677 170.1519
#> 2   PCA 0.4826527     0.4489127 281.8225 291.3826
```
